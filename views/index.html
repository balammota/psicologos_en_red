<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Psic√≥logos en Red - Tu Bienestar</title>
    <link rel="stylesheet" href="/estilos.css">
    <link rel="stylesheet" href="/chat-widget.css">
</head>
<body>
    <header class="main-header">
        <a href="/" class="logo" style="color: var(--primario-rosa); text-decoration: none; display: flex; align-items: center; gap: 10px;">
            <img src="/images/logo.png" alt="Logo" style="height: 40px; width: auto;">
            <span>Psic√≥logos en Red</span>
        </a>
        <input type="checkbox" id="nav-toggle" class="nav-toggle" aria-hidden="true" tabindex="-1">
        <label for="nav-toggle" class="nav-toggle-label" aria-label="Abrir men√∫"><span></span><span></span><span></span></label>
        <nav class="main-nav">
            <ul style="display: flex; list-style: none; gap: 25px; align-items: center;">
                <li><a href="/" data-i18n="nav_inicio" style="text-decoration: none; color: var(--texto-oscuro); font-weight: 500;">Inicio</a></li>
                <li><a href="/catalogo" data-i18n="nav_psicologos" style="text-decoration: none; color: var(--texto-oscuro); font-weight: 500;">Psic√≥logos</a></li>
                <li><a href="/academia" data-i18n="nav_academia" style="text-decoration: none; color: var(--texto-oscuro); font-weight: 500;">Academia</a></li>
                <li><a href="/perfil" class="btn-perfil" data-i18n="nav_mi_perfil" style="background: var(--primario-rosa); color: white; padding: 8px 18px; border-radius: 20px; text-decoration: none;">Mi Perfil</a></li>
            </ul>
        </nav>
    </header>

    <!-- Hero moderno: pantalla completa, gradiente, animaci√≥n -->
    <section class="hero hero-modern" id="inicio">
        <div class="hero-ribbon" aria-hidden="true">
            <span class="hero-ribbon-text">¬°Estrenamos Plataforma Digital!</span>
            <span class="hero-ribbon-sub">Seguimiento personalizado en un solo lugar.</span>
        </div>
        <div class="index-hero-gradient"></div>
        <div class="index-hero-bg" style="background-image: url('/images/hero.jpg');"></div>
        <div class="index-hero-blurs">
            <div class="index-hero-blur index-hero-blur-1"></div>
            <div class="index-hero-blur index-hero-blur-2"></div>
            <div class="index-hero-blur index-hero-blur-3"></div>
        </div>
        <div class="index-hero-content">
            <div class="index-hero-text">
                <h1 class="index-hero-title">
                    <span data-i18n="index_hero_title_prefix">Tu camino hacia el </span><span class="text-gradient" data-i18n="index_hero_bienestar">bienestar emocional</span>
                </h1>
                <p class="index-hero-subtitle" data-i18n="index_hero_desc">
                    Descubre un espacio seguro para explorar, sanar y crecer con el apoyo de profesionales expertos en salud mental.
                </p>
                <div class="index-hero-buttons">
                    <a href="#" id="btn-comenzar-ahora" class="btn-hero-primary glass-effect" data-i18n="index_hero_cta_primary">Agendar Ahora</a>
                    <a href="#servicios" class="btn-hero-secondary" data-i18n="index_hero_cta_secondary">Conocer M√°s</a>
                </div>
            </div>
            <div class="index-hero-image-wrap">
                <img src="/images/hero.jpg" alt="Bienestar emocional" class="index-hero-image floating">
            </div>
        </div>
    </section>

    <!-- Servicios -->
    <section class="servicios-container index-section index-servicios-wrap" id="servicios">
        <h2 class="index-section-title" data-i18n="index_servicios_titulo">Nuestros Servicios</h2>
        <p class="index-section-desc" data-i18n="index_servicios_desc">Ofrecemos una amplia gama de servicios terap√©uticos adaptados a tus necesidades espec√≠ficas.</p>
        <div class="servicios-grid servicios-grid-modern">
            <a href="#" class="servicio-card-modern servicio-card-v2 btn-abrir-modal-agendar">
                <div class="servicio-icon-wrap servicio-icon-rosa">
                    <span class="servicio-card-icon servicio-card-icon-rosa">üíª</span>
                </div>
                <h3 data-i18n="index_servicio_online_titulo">Psicoterapia Online</h3>
                <p data-i18n="index_servicio_online_texto">Apoyo profesional, seguro y confidencial. Acompa√±amiento efectivo para ansiedad, depresi√≥n, estr√©s y diversos desaf√≠os emocionales, con la flexibilidad que necesitas.</p>
                <span class="servicio-card-link" data-i18n="index_servicio_online_cta">Agendar Ahora ‚Üí</span>
            </a>
            <a href="/academia" class="servicio-card-modern servicio-card-v2">
                <div class="servicio-icon-wrap servicio-icon-azul">
                    <span class="servicio-card-icon servicio-card-icon-azul">üë©‚Äçüè´</span>
                </div>
                <h3 data-i18n="index_servicio_academia_titulo">Academia Virtual</h3>
                <p data-i18n="index_servicio_academia_texto">Cursos y diplomados en l√≠nea para psic√≥logos y estudiantes, fortaleciendo competencias con enfoque √©tico actualizado.</p>
                <span class="servicio-card-link" data-i18n="index_servicio_academia_cta">Explorar diplomados ‚Üí</span>
            </a>
            <a href="/catalogo?servicio=Asesoria%20de%20crianza" class="servicio-card-modern servicio-card-v2">
                <div class="servicio-icon-wrap servicio-icon-dorado">
                    <span class="servicio-card-icon servicio-card-icon-dorado">üë©‚Äçüçº</span>
                </div>
                <h3 data-i18n="index_servicio_crianza_titulo">Asesor√≠a de Crianza</h3>
                <p data-i18n="index_servicio_crianza_texto">Asesor√≠a en crianza con psic√≥logos: espacio seguro, herramientas pr√°cticas, v√≠nculo familiar y acompa√±amiento consciente real.</p>
                <span class="servicio-card-link" data-i18n="index_servicio_crianza_cta">Agendar Ahora ‚Üí</span>
            </a>
        </div>
    </section>

    <!-- Sobre Nosotros -->
    <section class="sobre-nosotros index-section index-section-alt index-sobre-nosotros-wrap" id="sobre-nosotros">
        <div class="about-wrapper index-about-wrapper">
            <div class="contenedor-flex">
                <div class="texto-nosotros index-texto-nosotros">
                    <span class="subtitulo" data-i18n="index_sobre_nosotros">Sobre Nosotros</span>
                    <h2 class="index-sobre-title" data-i18n="index_sobre_titulo">Humanizando la terapia a trav√©s de la tecnolog√≠a</h2>
                    <p class="highlight-p index-sobre-p" data-i18n="index_sobre_parrafo_1">Psic√≥logos en Red naci√≥ en 2020 para ofrecer acompa√±amiento emocional de calidad a distancia. Creemos que el bienestar emocional es un derecho fundamental: por eso eliminamos barreras geogr√°ficas con tecnolog√≠a y creamos espacios seguros donde la confidencialidad y el respeto son pilares de cada intervenci√≥n.</p>
                    <p class="index-sobre-p" data-i18n="index_sobre_parrafo_2">Nuestra metodolog√≠a integra evidencia cient√≠fica con terapia personalizada y formaci√≥n continua para profesionales. Estamos comprometidos con generar un impacto positivo en la salud mental colectiva, construyendo una comunidad donde la empat√≠a y la innovaci√≥n transforman vidas de manera real y duradera.</p>
                    <a href="/nosotros" class="btn-principal" data-i18n="index_conocemos">Con√≥cenos</a>
                </div>
                <div class="imagen-nosotros-container">
                    <a href="#testimonios-section" class="cuadro-decorativo-v2">
                        <span class="cifra" data-i18n="index_cifra">+1000</span>
                        <p class="bajada" data-i18n="index_vidas">Vidas transformadas</p>
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- Nuestro equipo: se puebla desde la tabla de psic√≥logos (cada burbuja enlaza a su perfil en cat√°logo) -->
    <section class="equipo-slider-section" id="nuestro-equipo">
        <h2 style="text-align: center; color: var(--texto-oscuro); margin-bottom: 40px;" data-i18n="index_equipo_titulo">Conoce a nuestro equipo</h2>
        <div class="equipo-slider-viewport" id="equipo-slider-viewport">
            <div class="equipo-slider-container" id="equipo-slider-container">
                <!-- Se llena por JS con /api/psicologos -->
            </div>
        </div>
        <div class="slider-nav-dots"></div>
    </section>

    <!-- Testimonios: 3 bloques (izq, centro, der) con 9 comentarios rotando a distintos tiempos -->
    <section class="testimonios-section index-section index-testimonios-wrap" id="testimonios-section">
        <span class="subtitulo" data-i18n="index_testimonios_sub">Lo que dicen nuestros pacientes</span>
        <h2 class="index-section-title" data-i18n="index_testimonios_titulo">Experiencias que transforman</h2>
        <p class="index-section-desc" data-i18n="index_testimonios_desc">Historias reales de personas que han transformado sus vidas.</p>
        <div class="testimonios-container index-testimonios-cards testimonios-triple-wrap">
            <div id="testimonio-rotador-1" class="testimonio-card index-testimonio-v2 testimonio-rotador-card">
                <div class="testimonio-stars" id="testimonio-stars-1">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
                <p class="testimonio-quote" id="testimonio-quote-1">Cargando...</p>
                <div class="testimonio-author">
                    <div class="testimonio-avatar testimonio-avatar-rosa" id="testimonio-avatar-1">--</div>
                    <div class="testimonio-info">
                        <strong class="testimonio-name" id="testimonio-name-1">‚Äî</strong>
                        <span id="testimonio-rol-1">‚Äî</span>
                    </div>
                </div>
            </div>
            <div id="testimonio-rotador-2" class="testimonio-card index-testimonio-v2 testimonio-rotador-card">
                <div class="testimonio-stars" id="testimonio-stars-2">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
                <p class="testimonio-quote" id="testimonio-quote-2">Cargando...</p>
                <div class="testimonio-author">
                    <div class="testimonio-avatar testimonio-avatar-rosa" id="testimonio-avatar-2">--</div>
                    <div class="testimonio-info">
                        <strong class="testimonio-name" id="testimonio-name-2">‚Äî</strong>
                        <span id="testimonio-rol-2">‚Äî</span>
                    </div>
                </div>
            </div>
            <div id="testimonio-rotador-3" class="testimonio-card index-testimonio-v2 testimonio-rotador-card">
                <div class="testimonio-stars" id="testimonio-stars-3">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
                <p class="testimonio-quote" id="testimonio-quote-3">Cargando...</p>
                <div class="testimonio-author">
                    <div class="testimonio-avatar testimonio-avatar-rosa" id="testimonio-avatar-3">--</div>
                    <div class="testimonio-info">
                        <strong class="testimonio-name" id="testimonio-name-3">‚Äî</strong>
                        <span id="testimonio-rol-3">‚Äî</span>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <style>
        .testimonios-triple-wrap { display: flex; flex-wrap: wrap; justify-content: center; gap: 1.25rem; max-width: 1100px; margin: 0 auto; min-height: 220px; }
        .testimonios-triple-wrap .testimonio-rotador-card { flex: 1 1 280px; max-width: 340px; min-width: 260px; }
        .testimonio-rotador-card { transition: opacity 0.5s ease; }
        .testimonio-rotador-card.fade-out { opacity: 0; }
    </style>
    <script>
        (function() {
            var fallback = [
                { nombre: 'Juan S.', comentario: 'La plataforma es s√∫per sencilla de usar. Encontr√© al psic√≥logo ideal para mi proceso.', valoracion: '5', rol: 'Paciente' },
                { nombre: 'Mar√≠a L.', comentario: 'Me encanta la privacidad que ofrece. Poder tomar mi terapia desde casa me ha cambiado la vida.', valoracion: '5', rol: 'Paciente' },
                { nombre: 'Dr. Roberto B.', comentario: 'Como profesional, la red me permite organizar mis consultas y llegar a quienes necesitan apoyo.', valoracion: '5', rol: 'Psic√≥logo' }
            ];
            var items = [];
            var indices = [0, 0, 0];
            var delays = [4000, 5500, 7000];

            function estrellas(n) { n = Math.min(5, Math.max(0, parseInt(n, 10) || 5)); return '‚òÖ'.repeat(n) + '‚òÜ'.repeat(5 - n); }
            function inicialUnica(nombre) { var s = (nombre || '').trim(); return s ? s.charAt(0).toUpperCase() : '‚Äî'; }
            function shuffle(arr) {
                var a = arr.slice();
                for (var i = a.length - 1; i > 0; i--) {
                    var j = Math.floor(Math.random() * (i + 1));
                    var t = a[i]; a[i] = a[j]; a[j] = t;
                }
                return a;
            }

            function renderBlock(blockIndex) {
                var list = items.length ? items : fallback;
                if (!list.length) return;
                var listLen = list.length;
                indices[blockIndex] = indices[blockIndex] % listLen;
                if (indices[blockIndex] < 0) indices[blockIndex] += listLen;
                var t = list[indices[blockIndex]];
                var n = blockIndex + 1;
                var card = document.getElementById('testimonio-rotador-' + n);
                if (!card) return;
                card.classList.add('fade-out');
                setTimeout(function() {
                    var starsEl = document.getElementById('testimonio-stars-' + n);
                    var quoteEl = document.getElementById('testimonio-quote-' + n);
                    var avatarEl = document.getElementById('testimonio-avatar-' + n);
                    var nameEl = document.getElementById('testimonio-name-' + n);
                    var rolEl = document.getElementById('testimonio-rol-' + n);
                    if (starsEl) starsEl.textContent = estrellas(t.valoracion);
                    if (quoteEl) quoteEl.textContent = (t.comentario && !t.comentario.match(/^["']/) ? '"' : '') + (t.comentario || '') + (t.comentario && !t.comentario.match(/["']$/) ? '"' : '');
                    var inicial = inicialUnica(t.nombre);
                    if (avatarEl) avatarEl.textContent = inicial;
                    if (nameEl) nameEl.textContent = inicial !== '‚Äî' ? inicial + '.' : '‚Äî';
                    if (rolEl) rolEl.textContent = t.rol === 'psicologo' ? 'Psic√≥logo' : (t.rol === 'paciente' ? 'Paciente' : (t.rol || '‚Äî'));
                    card.classList.remove('fade-out');
                }, 350);
            }

            function runRotators() {
                for (var b = 0; b < 3; b++) {
                    (function(blockIndex) {
                        renderBlock(blockIndex);
                        setInterval(function() {
                            indices[blockIndex]++;
                            renderBlock(blockIndex);
                        }, delays[blockIndex]);
                    })(b);
                }
            }

            fetch('/api/testimonios-encuesta').then(function(r) { return r.json(); }).then(function(data) {
                if (Array.isArray(data) && data.length > 0) {
                    var mapped = data.map(function(x) {
                        return { nombre: x.nombre, comentario: x.comentario, valoracion: x.valoracion, rol: x.rol };
                    });
                    items = shuffle(mapped).slice(0, 9);
                }
                runRotators();
            }).catch(function() {
                items = [];
                runRotators();
            });
        })();
    </script>

    <!-- FAQ -->
    <section class="faq-section index-section index-section-alt index-faq-wrap" id="faq">
        <span class="subtitulo" data-i18n="index_faq_sub">Tus dudas resueltas</span>
        <h2 class="index-section-title" data-i18n="index_faq_titulo">Preguntas Frecuentes</h2>
        <p class="index-section-desc" data-i18n="index_faq_desc">Resolvemos tus dudas m√°s comunes.</p>
        <div class="faq-container faq-container-modern index-faq-panels">
            <details class="faq-item faq-item-modern faq-item-v2">
                <summary data-i18n="index_faq_1_pregunta">¬øC√≥mo elijo al psic√≥logo adecuado para m√≠?</summary>
                <div class="faq-content faq-content-v2">
                    <p data-i18n="index_faq_1_respuesta">Al registrarte, podr√°s ver los perfiles de nuestros especialistas, sus √°reas de enfoque y a√±os de experiencia para que elijas al que mejor se adapte a tus necesidades.</p>
                </div>
            </details>
            <details class="faq-item faq-item-modern faq-item-v2">
                <summary data-i18n="index_faq_2_pregunta">¬øLas sesiones de video son privadas?</summary>
                <div class="faq-content faq-content-v2">
                    <p data-i18n="index_faq_2_respuesta">Absolutamente. Utilizamos una plataforma de videollamadas segura (Daily) con salas privadas por sesi√≥n, de modo que nadie m√°s pueda acceder a tu sesi√≥n.</p>
                </div>
            </details>
            <details class="faq-item faq-item-modern faq-item-v2">
                <summary data-i18n="index_faq_3_pregunta">¬øQu√© necesito para mi primera consulta?</summary>
                <div class="faq-content faq-content-v2">
                    <p data-i18n="index_faq_3_respuesta">Solo necesitas un dispositivo con c√°mara y micr√≥fono (computadora o celular) y una conexi√≥n a internet estable. Recomendamos un lugar tranquilo y privado.</p>
                </div>
            </details>
            <details class="faq-item faq-item-modern faq-item-v2">
                <summary data-i18n="index_faq_4_pregunta">¬øCu√°les son los m√©todos de pago?</summary>
                <div class="faq-content faq-content-v2">
                    <p data-i18n="index_faq_4_respuesta">Aceptamos tarjetas de cr√©dito, d√©bito y transferencias bancarias. El pago se realiza de forma segura antes de iniciar la sesi√≥n.</p>
                </div>
            </details>
        </div>
    </section>

    <!-- CTA final -->
    <section class="index-cta-section">
        <div class="index-cta-gradient"></div>
        <div class="index-cta-content">
            <h2 class="index-cta-title" data-i18n="index_cta_title">¬øEst√°s listo para iniciar tu proceso?</h2>
            <p class="index-cta-desc" data-i18n="index_cta_desc">Da el primer paso hacia tu bienestar emocional. Agenda una consulta hoy mismo.</p>
            <a href="#" id="btn-cta-agendar" class="btn-hero-primary glass-effect" data-i18n="index_cta_btn">Agendar Consulta</a>
        </div>
    </section>

    <!-- Modal: ¬øEres nuevo o ya conoces nuestros servicios? -->
    <div id="modal-bienvenida" class="modal-bienvenida-overlay" role="dialog" aria-modal="true" aria-labelledby="modal-bienvenida-titulo" style="display: none;">
        <div class="modal-bienvenida-box">
            <button type="button" class="modal-bienvenida-cerrar" id="modal-bienvenida-cerrar" aria-label="Cerrar">&times;</button>

            <!-- Paso 1: ¬øEres nuevo o ya conoces? -->
            <div id="modal-paso-1" class="modal-bienvenida-paso">
                <h2 id="modal-bienvenida-titulo" class="modal-bienvenida-titulo" data-i18n="modal_bienvenida_pregunta">¬øEres nuevo o ya conoces nuestros servicios?</h2>
                <p class="modal-bienvenida-sub" data-i18n="modal_bienvenida_sub">Elige la opci√≥n que mejor te describa</p>
                <div class="modal-bienvenida-botones">
                    <button type="button" class="modal-bienvenida-btn modal-bienvenida-btn-nuevo" data-paso="nuevo" data-i18n="modal_soy_nuevo">Soy nuevo</button>
                    <button type="button" class="modal-bienvenida-btn modal-bienvenida-btn-conozco" data-paso="conozco" data-i18n="modal_ya_conozco">Ya conozco los servicios</button>
                </div>
            </div>

            <!-- Paso 2a: Nuevo ‚Üí ¬øQu√© servicio buscas? -->
            <div id="modal-paso-servicio" class="modal-bienvenida-paso" style="display: none;">
                <button type="button" class="modal-bienvenida-volver" id="modal-volver-paso1" aria-label="Volver">‚Üê <span data-i18n="modal_volver">Volver</span></button>
                <h2 class="modal-bienvenida-titulo" data-i18n="modal_que_servicio">¬øQu√© servicio est√°s buscando?</h2>
                <p class="modal-bienvenida-sub" data-i18n="modal_que_servicio_sub">Selecciona una opci√≥n</p>
                <div class="modal-bienvenida-opciones">
                    <button type="button" class="modal-bienvenida-opcion modal-bienvenida-opcion-btn" id="modal-btn-terapia-individual">Terapia individual</button>
                    <a href="/catalogo?servicio=Terapia%20de%20pareja" class="modal-bienvenida-opcion" data-i18n="modal_terapia_pareja">Terapia de pareja</a>
                    <a href="/academia" class="modal-bienvenida-opcion" data-i18n="modal_diplomados">Diplomados para psic√≥logos</a>
                </div>
            </div>

            <!-- Paso 2b-bis: Edad (solo si eligi√≥ Terapia individual) -->
            <div id="modal-paso-edad" class="modal-bienvenida-paso" style="display: none;">
                <button type="button" class="modal-bienvenida-volver" id="modal-volver-edad-a-servicio" aria-label="Volver">‚Üê Volver</button>
                <h2 class="modal-bienvenida-titulo">Dinos tu edad</h2>
                <p class="modal-bienvenida-sub">Selecciona una opci√≥n</p>
                <div class="modal-bienvenida-opciones">
                    <button type="button" class="modal-bienvenida-opcion modal-bienvenida-opcion-btn" id="modal-btn-mas-18">+18 a√±os</button>
                    <button type="button" class="modal-bienvenida-opcion modal-bienvenida-opcion-btn" id="modal-btn-menos-18">-18 a√±os</button>
                </div>
            </div>

            <!-- Paso 2b-ter: Menores de 18 (mensaje para que contacten con padre/guardi√°n) -->
            <div id="modal-paso-menores" class="modal-bienvenida-paso" style="display: none;">
                <h2 class="modal-bienvenida-titulo modal-bienvenida-titulo-rosa">Gracias por tu inter√©s</h2>
                <p class="modal-bienvenida-mensaje">Nos encanta ver que te intereses en tu bienestar emocional. Por favor p√≠dele a tu(s) padre(s) o guardi√°n(es) que se contacten con nosotros a: <a href="mailto:contacto@psicologosenred.com" class="modal-enlace-email">contacto@psicologosenred.com</a></p>
                <button type="button" class="modal-bienvenida-btn modal-bienvenida-btn-cta" id="modal-btn-menores-entendido">Entendido</button>
            </div>

            <!-- Paso 2c: Encuesta de corriente (una pregunta por pantalla, 4 burbujas como el resto del modal) -->
            <div id="modal-paso-encuesta" class="modal-bienvenida-paso" style="display: none;">
                <button type="button" class="modal-bienvenida-volver" id="modal-volver-encuesta" aria-label="Volver">‚Üê Volver</button>
                <p class="encuesta-indicador" id="encuesta-indicador">Pregunta 1 de 5</p>
                <h2 class="modal-bienvenida-titulo encuesta-pregunta-titulo" id="encuesta-pregunta-texto"></h2>
                <div class="modal-bienvenida-opciones" id="encuesta-burbujas"></div>
            </div>

            <!-- Paso 2d: Resultado encuesta ‚Üí Te dirigiremos con los mejores psic√≥logos -->
            <div id="modal-paso-resultado" class="modal-bienvenida-paso" style="display: none;">
                <h2 class="modal-bienvenida-titulo modal-bienvenida-titulo-rosa">Te dirigiremos con los mejores psic√≥logos para ti</h2>
                <p class="modal-bienvenida-mensaje">Seg√∫n tus respuestas, te recomendamos especialistas en el enfoque que mejor se adapta a lo que buscas.</p>
                <a href="#" id="modal-btn-ir-catalogo-filtrado" class="modal-bienvenida-btn modal-bienvenida-btn-cta">Ver psic√≥logos recomendados</a>
            </div>

            <!-- Paso 2b: Ya conozco ‚Üí Opciones: Ir a Psic√≥logos, Ir a Academia, Cerrar -->
            <div id="modal-paso-bienvenida" class="modal-bienvenida-paso" style="display: none;">
                <h2 class="modal-bienvenida-titulo modal-bienvenida-titulo-rosa" data-i18n="modal_bienvenido_vuelta">Bienvenido de vuelta</h2>
                <p class="modal-bienvenida-mensaje" data-i18n="modal_bienvenido_mensaje">Seguimos aqu√≠ para acompa√±arte. ¬øA d√≥nde quieres ir?</p>
                <div class="modal-bienvenida-botones modal-bienvenida-botones-tres">
                    <a href="/catalogo" class="modal-bienvenida-btn modal-bienvenida-btn-cta">Ir a Psic√≥logos</a>
                    <a href="/academia" class="modal-bienvenida-btn modal-bienvenida-btn-cta">Ir a Academia</a>
                    <button type="button" class="modal-bienvenida-btn modal-bienvenida-btn-sec" id="modal-cerrar-bienvenida">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            fetch('/api/estado-sesion')
                .then(res => res.json())
                .then(data => {
                    const btnPerfil = document.querySelector('.btn-perfil') || document.querySelector('a[href="/perfil"]');
                    if (data.autenticado && btnPerfil) {
                        const primerNombre = data.nombre.split(' ')[0];
                        btnPerfil.innerHTML = `<span>üë§ Sitio de ${primerNombre}</span>`;
                        btnPerfil.href = (data.rol === 'psicologo') ? "/panel-doctor" : "/perfil";
                    }
                })
                .catch(err => console.log("Error verificando sesi√≥n:", err));

            // Modal bienvenida: Comenzar Ahora / Agendar Consulta
            const modal = document.getElementById('modal-bienvenida');
            const btnComenzar = document.getElementById('btn-comenzar-ahora');
            const btnCtaAgendar = document.getElementById('btn-cta-agendar');
            const btnCerrar = document.getElementById('modal-bienvenida-cerrar');
            const paso1 = document.getElementById('modal-paso-1');
            const pasoServicio = document.getElementById('modal-paso-servicio');
            const pasoEdad = document.getElementById('modal-paso-edad');
            const pasoMenores = document.getElementById('modal-paso-menores');
            const pasoEncuesta = document.getElementById('modal-paso-encuesta');
            const pasoResultado = document.getElementById('modal-paso-resultado');
            const pasoBienvenida = document.getElementById('modal-paso-bienvenida');
            const btnVolver = document.getElementById('modal-volver-paso1');
            const btnVolverEdad = document.getElementById('modal-volver-edad-a-servicio');
            const btnVolverEncuesta = document.getElementById('modal-volver-encuesta');
            const btnCerrarBienvenida = document.getElementById('modal-cerrar-bienvenida');

            function abrirModal() {
                modal.style.display = 'flex';
                paso1.style.display = 'block';
                pasoServicio.style.display = 'none';
                pasoEdad.style.display = 'none';
                pasoMenores.style.display = 'none';
                pasoEncuesta.style.display = 'none';
                pasoResultado.style.display = 'none';
                pasoBienvenida.style.display = 'none';
            }

            function cerrarModal() {
                modal.style.display = 'none';
            }

            if (btnComenzar) btnComenzar.addEventListener('click', function(e) { e.preventDefault(); abrirModal(); });
            if (btnCtaAgendar) btnCtaAgendar.addEventListener('click', function(e) { e.preventDefault(); abrirModal(); });
            document.querySelectorAll('.btn-abrir-modal-agendar').forEach(function(btn) {
                btn.addEventListener('click', function(e) { e.preventDefault(); abrirModal(); });
            });
            if (btnCerrar) btnCerrar.addEventListener('click', cerrarModal);
            if (btnCerrarBienvenida) btnCerrarBienvenida.addEventListener('click', cerrarModal);

            modal.addEventListener('click', function(e) {
                if (e.target === modal) cerrarModal();
            });

            document.querySelectorAll('.modal-bienvenida-btn-nuevo, .modal-bienvenida-btn-conozco').forEach(btn => {
                btn.addEventListener('click', function() {
                    const paso = this.getAttribute('data-paso');
                    paso1.style.display = 'none';
                    if (paso === 'nuevo') {
                        pasoServicio.style.display = 'block';
                        pasoBienvenida.style.display = 'none';
                    } else {
                        pasoServicio.style.display = 'none';
                        pasoBienvenida.style.display = 'block';
                    }
                });
            });

            if (btnVolver) btnVolver.addEventListener('click', function() {
                pasoServicio.style.display = 'none';
                pasoEdad.style.display = 'none';
                pasoMenores.style.display = 'none';
                pasoEncuesta.style.display = 'none';
                pasoResultado.style.display = 'none';
                pasoBienvenida.style.display = 'none';
                paso1.style.display = 'block';
            });

            if (btnVolverEdad) btnVolverEdad.addEventListener('click', function() {
                pasoEdad.style.display = 'none';
                pasoServicio.style.display = 'block';
            });

            document.getElementById('modal-btn-menores-entendido').addEventListener('click', cerrarModal);

            var encuestaPasoActual = 1;
            var encuestaRespuestas = [null, null, null, null, null];
            var encuestaPreguntas = [
                { texto: '¬øEn qu√© aspecto de tu vida prefieres centrar el trabajo inicial?', opciones: [
                    { texto: 'En mis pensamientos actuales y en c√≥mo cambiar mis conductas diarias.', valor: 'TCC' },
                    { texto: 'En entender el origen de mis conflictos y c√≥mo mi pasado influye en mi presente.', valor: 'Psicoanalisis' },
                    { texto: 'En mis relaciones actuales y la forma en que interact√∫o con mi entorno (familia, pareja, trabajo).', valor: 'Sistemica' },
                    { texto: 'En mi crecimiento personal, mis valores y el sentido que le doy a mi vida.', valor: 'Humanista' }
                ]},
                { texto: 'Si tuvieras que elegir el "estilo" de la sesi√≥n, ¬øcu√°l te har√≠a sentir m√°s c√≥modo?', opciones: [
                    { texto: 'Estructurado: con metas claras, tareas para la semana y ejercicios pr√°cticos.', valor: 'TCC' },
                    { texto: 'Exploratorio: hablando libremente sobre lo que venga a mi mente para descubrir significados ocultos.', valor: 'Psicoanalisis' },
                    { texto: 'Din√°mico: analizando los roles que juego en mi familia o grupos sociales.', valor: 'Sistemica' },
                    { texto: 'Emp√°tico y reflexivo: un espacio de aceptaci√≥n total para explorar mis sentimientos.', valor: 'Humanista' }
                ]},
                { texto: '¬øCu√°l de estas frases describe mejor lo que esperas de tu psic√≥logo?', opciones: [
                    { texto: '"Espero que me d√© herramientas concretas para manejar mis s√≠ntomas (insomnio, estr√©s, fobias)".', valor: 'TCC' },
                    { texto: '"Espero que me ayude a profundizar en mis procesos inconscientes y traumas".', valor: 'Psicoanalisis' },
                    { texto: '"Espero que me ayude a mejorar la comunicaci√≥n y los l√≠mites con las personas que me rodean".', valor: 'Sistemica' },
                    { texto: '"Espero que me acompa√±e en mi proceso de autodescubrimiento y realizaci√≥n personal".', valor: 'Humanista' }
                ]},
                { texto: '¬øC√≥mo visualizas la duraci√≥n y el enfoque del proceso?', opciones: [
                    { texto: 'Breve y enfocado en resolver un problema espec√≠fico lo antes posible.', valor: 'TCC' },
                    { texto: 'A largo plazo, buscando un cambio profundo en mi estructura de personalidad.', valor: 'Psicoanalisis' },
                    { texto: 'Variable, enfocado en cambiar la din√°mica de mis relaciones actuales.', valor: 'Sistemica' },
                    { texto: 'Enfocado en el "aqu√≠ y ahora", sin una duraci√≥n r√≠gidamente predeterminada.', valor: 'Humanista' }
                ]},
                { texto: 'Ante una situaci√≥n dif√≠cil, ¬øqu√© buscas entender primordialmente?', opciones: [
                    { texto: 'Qu√© pensamientos autom√°ticos me est√°n haciendo da√±o.', valor: 'TCC' },
                    { texto: 'Qu√© patr√≥n de mi infancia estoy repitiendo sin darme cuenta.', valor: 'Psicoanalisis' },
                    { texto: 'C√≥mo estoy influyendo en los dem√°s y c√≥mo ellos influyen en m√≠.', valor: 'Sistemica' },
                    { texto: 'Qui√©n soy realmente frente a esta situaci√≥n y qu√© quiero decidir.', valor: 'Humanista' }
                ]}
            ];

            function encuestaRenderPregunta(paso) {
                encuestaPasoActual = paso;
                document.getElementById('encuesta-indicador').textContent = 'Pregunta ' + paso + ' de 5';
                var p = encuestaPreguntas[paso - 1];
                document.getElementById('encuesta-pregunta-texto').textContent = p.texto;
                var contenedor = document.getElementById('encuesta-burbujas');
                contenedor.innerHTML = '';
                p.opciones.forEach(function(opt) {
                    var btn = document.createElement('button');
                    btn.type = 'button';
                    btn.className = 'modal-bienvenida-opcion modal-bienvenida-opcion-btn';
                    btn.textContent = opt.texto;
                    btn.dataset.valor = opt.valor;
                    btn.addEventListener('click', function() {
                        encuestaRespuestas[paso - 1] = opt.valor;
                        if (paso < 5) {
                            encuestaRenderPregunta(paso + 1);
                        } else {
                            var puntos = { TCC: 0, Psicoanalisis: 0, Sistemica: 0, Humanista: 0 };
                            encuestaRespuestas.forEach(function(v) { if (v) puntos[v]++; });
                            var maxPuntos = Math.max(puntos.TCC, puntos.Psicoanalisis, puntos.Sistemica, puntos.Humanista);
                            var ganadores = ['TCC', 'Psicoanalisis', 'Sistemica', 'Humanista'].filter(function(c) { return puntos[c] === maxPuntos; });
                            var corrienteGanadora = ganadores.length === 1 ? ganadores[0] : ganadores[Math.floor(Math.random() * ganadores.length)];
                            document.getElementById('modal-btn-ir-catalogo-filtrado').href = '/catalogo?corriente=' + encodeURIComponent(corrienteGanadora);
                            pasoEncuesta.style.display = 'none';
                            pasoResultado.style.display = 'block';
                        }
                    });
                    contenedor.appendChild(btn);
                });
            }

            if (btnVolverEncuesta) btnVolverEncuesta.addEventListener('click', function() {
                if (encuestaPasoActual === 1) {
                    pasoEncuesta.style.display = 'none';
                    pasoResultado.style.display = 'none';
                    pasoEdad.style.display = 'block';
                } else {
                    encuestaRenderPregunta(encuestaPasoActual - 1);
                }
            });

            document.getElementById('modal-btn-terapia-individual').addEventListener('click', function() {
                pasoServicio.style.display = 'none';
                pasoEdad.style.display = 'block';
                pasoMenores.style.display = 'none';
                pasoEncuesta.style.display = 'none';
                pasoResultado.style.display = 'none';
            });

            document.getElementById('modal-btn-mas-18').addEventListener('click', function() {
                pasoEdad.style.display = 'none';
                pasoEncuesta.style.display = 'block';
                pasoResultado.style.display = 'none';
                encuestaRespuestas = [null, null, null, null, null];
                encuestaRenderPregunta(1);
            });

            document.getElementById('modal-btn-menos-18').addEventListener('click', function() {
                pasoEdad.style.display = 'none';
                pasoMenores.style.display = 'block';
            });

            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape' && modal.style.display === 'flex') cerrarModal();
            });

            // Si se lleg√≥ desde perfil (CTA "Agendar Cita") con ?modal=agendar, abrir el modal
            if (window.location.search.indexOf('modal=agendar') !== -1) {
                setTimeout(abrirModal, 100);
            }

            // Equipo: cargar psic√≥logos reales y montar carrusel
            const equipoSection = document.getElementById('nuestro-equipo');
            const equipoContainer = document.getElementById('equipo-slider-container');
            fetch('/api/psicologos')
                .then(function(r) { return r.json(); })
                .then(function(psicologos) {
                    const lista = Array.isArray(psicologos) ? psicologos : [];
                    if (lista.length === 0) {
                        if (equipoSection) equipoSection.style.display = 'none';
                        return;
                    }
                    equipoContainer.innerHTML = '';
                    var viewportEl = document.getElementById('equipo-slider-viewport');
                    if (viewportEl) viewportEl.style.setProperty('--equipo-num-slides', String(lista.length));
                    lista.forEach(function(p) {
                        const nombreCorto = (p.nombre || '').trim().split(/\s+/);
                        const displayName = nombreCorto.length >= 2
                            ? (nombreCorto[0] + ' ' + nombreCorto[nombreCorto.length - 1].charAt(0) + '.')
                            : (p.nombre || '‚Äî');
                        const imgSrc = (p.imagen_url && p.imagen_url.trim()) ? p.imagen_url : '/images/avatar-david.jpg';
                        const slide = document.createElement('a');
                        slide.href = '/catalogo?ver=' + encodeURIComponent(p.id);
                        slide.className = 'equipo-slide';
                        slide.setAttribute('aria-label', 'Ver perfil de ' + (p.nombre || ''));
                        const img = document.createElement('img');
                        img.src = imgSrc;
                        img.alt = p.nombre || '';
                        slide.appendChild(img);
                        const span = document.createElement('span');
                        span.className = 'nombre-equipo';
                        span.textContent = displayName;
                        slide.appendChild(span);
                        equipoContainer.appendChild(slide);
                    });
                    // Carrusel (mismo dise√±o que antes)
                    const slider = document.querySelector('.equipo-slider-container');
                    const slides = document.querySelectorAll('.equipo-slider-container > .equipo-slide');
                    if (slider && slides.length) {
                        const itemsToShow = Math.min(4, slides.length);
                        let currentIndex = itemsToShow;
                        for (let i = 0; i < itemsToShow; i++) {
                            const startClone = slides[i].cloneNode(true);
                            const endClone = slides[slides.length - 1 - (i % slides.length)].cloneNode(true);
                            slider.appendChild(startClone);
                            slider.insertBefore(endClone, slides[0]);
                        }
                        const allSlides = document.querySelectorAll('.equipo-slider-container > .equipo-slide');
                        function updateSlider(smooth) {
                            if (allSlides[0]) {
                                const slideWidth = allSlides[0].offsetWidth;
                                slider.style.transition = smooth !== false ? 'transform 0.5s ease-in-out' : 'none';
                                slider.style.transform = 'translateX(' + (-currentIndex * slideWidth) + 'px)';
                            }
                        }
                        window.addEventListener('load', function() { updateSlider(false); });
                        setTimeout(updateSlider, 100);
                        function moveNext() {
                            currentIndex++;
                            updateSlider(true);
                            if (currentIndex >= allSlides.length - itemsToShow) {
                                setTimeout(function() {
                                    currentIndex = itemsToShow;
                                    updateSlider(false);
                                }, 500);
                            }
                        }
                        let teamAutoPlay = setInterval(moveNext, 3000);
                        slider.addEventListener('mouseenter', function() { clearInterval(teamAutoPlay); });
                        slider.addEventListener('mouseleave', function() { teamAutoPlay = setInterval(moveNext, 3000); });
                    }
                })
                .catch(function() {
                    if (equipoSection) equipoSection.style.display = 'none';
                });
        });
    </script>

    <footer class="main-footer" style="background: #332E2A; border-top: 4px solid var(--primario-rosa);">
        <div class="footer-container">
            <div class="footer-col">
                <h3 style="color: var(--primario-rosa);">Psic√≥logos en Red</h3>
                <p data-i18n="footer_tagline">Conectando salud mental con tecnolog√≠a humana. Tu bienestar es nuestra prioridad.</p>
                <div class="redes-sociales">
                    <a href="https://www.facebook.com/profile.php?id=100063577030818" target="_blank" rel="noopener noreferrer" title="Facebook"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg></a>
                    <a href="https://www.instagram.com/psicologos_en_red" target="_blank" rel="noopener noreferrer" title="Instagram"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/></svg></a>
                    <a href="https://www.tiktok.com/@psicologos_en_red_" target="_blank" rel="noopener noreferrer" title="TikTok"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1z"/></svg></a>
                </div>
            </div>
            <div class="footer-col">
                <h4 style="color: var(--acento-dorado);">Enlaces R√°pidos</h4>
                <ul style="list-style: none; padding: 0;">
                    <li><a href="/" style="color: var(--suave-arena); text-decoration: none;">Inicio</a></li>
                    <li><a href="/registro" style="color: var(--suave-arena); text-decoration: none;">Registro</a></li>
                    <li><a href="/login" style="color: var(--suave-arena); text-decoration: none;">Iniciar Sesi√≥n</a></li>
                    <li><a href="/terminos-condiciones" style="color: var(--suave-arena); text-decoration: none;">T√©rminos y Condiciones</a></li>
                    <li><a href="/aviso-privacidad" style="color: var(--suave-arena); text-decoration: none;">Aviso de Privacidad</a></li>
                    <li><a href="/contacto" style="color: var(--suave-arena); text-decoration: none;">Contacto</a></li>
                    <li><a href="/trabaja-con-nosotros" style="color: var(--suave-arena); text-decoration: none;">Trabaja con Nosotros</a></li>
                </ul>
            </div>
            <div class="footer-col">
                <h4 style="color: var(--acento-dorado);">Contacto</h4>
                <p>üìç Ciudad de M√©xico, M√©xico</p>
                <p>üìß contacto@psicologosenred.com</p>
                <p>üìû +52 55 3077 6194</p>
            </div>
        </div>
        <div class="footer-bottom">
            <p style="color: var(--suave-arena); opacity: 0.7;">&copy; 2026 Psic√≥logos en Red. <span data-i18n="footer_derechos">Todos los derechos reservados.</span></p>
        </div>
    </footer>

    <script src="/i18n.js"></script>
    <script src="/chat-widget.js"></script>
</body>
</html>
